\documentclass{beamer}

%% Configuración de la presentación
\mode<presentation> {
  %%% Selección de estilo
  % The Beamer class comes with a number of default slide themes
  % which change the colors and layouts of slides. Below this is a list
  % of all the themes, uncomment each in turn to see what they look like.

  \usetheme{Warsaw}


  %% Configuración del pie de línea
  %\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
  %\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line
  %\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

%% Fuentes de tamaño arbitrario
\usepackage{lmodern}

%% Gráficos
\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables

%%% Castellano.
% noquoting: Permite uso de comillas no españolas.
% lcroman: Permite la enumeración con numerales romanos en minúscula.
% fontenc: Usa la fuente completa para que pueda copiarse correctamente del pdf.
\usepackage[spanish,es-noquoting,es-lcroman]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\selectlanguage{spanish}

%----------------------------------------------------------------------------------------
%	TÍTULO
%----------------------------------------------------------------------------------------


\title{Integración numérica de Gauss-Lobatto} % The short title appears at the bottom of every slide, the full title is only on the title page

\author[Jesús de Juan, Jürgen León, Pablo Navarro, María C. Sánchez]{Jesús de Juan López \\
        Jürgen León Martín \\
        Pablo Navarro Rubio \\
        María Cruz Sánchez Montoya} % Your name
\institute[UPV] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{ Trabajo I4, Grupo 2 \\ % Your institution for the title page
}
\date{Universidad Politécnica de Valencia} % Date, can be changed to a custom date


\begin{document}

%% Diapositiva de título.
\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

%% Diapositiva de contenidos.
% Throughout your presentation, if you choose to use \section{} and \subsection{} commands, 
% these will automatically be printed on this slide as an overview of your presentation
\begin{frame}
  \frametitle{Índice} % Table of contents slide, comment this block out to remove it
  \tableofcontents
\end{frame}



%----------------------------------------------------------------------------------------
%	PRESENTACIÓN
%----------------------------------------------------------------------------------------

%------------------------------------------------
\section{Introducción} % Sections can be created in order to organize your presentation into discrete blocks, all sections and subsections are automatically printed in the table of contents as an overview of the talk
%------------------------------------------------

%\subsection{Subsection Example} % A subsection can be created just before a set of slides with a common theme to further break down your presentation into chunks

\begin{frame}
\frametitle{Introducción}
Fórmula de cuadratura de \textcolor{blue}{Gauss-Lobatto} para \textcolor{blue}{n} nodos:
\[
\int_{-1}^{1} \! f(t)  \,dt = w_1 f(-1) + w_n f(1) + \sum_{i=1}^{n-1}w_i f(t_i),
\]
\\~\\

donde $t_i$, $i=2, 3,...,n-1$, son las raíces del polinomio $p'_{n-1}(t)$, siendo $p_{n-1}(t)$ el polinomio de Legendre de grado $n-1$. Los \textcolor{blue}{pesos} son $w_1 = w_n = \tfrac{2}{n(n-1)}$ y
\[
w_i=\frac{2}{n(n-1)(p_{n-1}(t_i))^2},\qquad i=2,3,...,n-1.
\].
\end{frame}

%------------------------------------------------
\section{Construcción del programa de Gauss-Lobatto}
\begin{frame}
\frametitle{Construcción del programa de Gauss-Lobatto}

\begin{table}
    \centering
    \begin{tabular}{cc}
    \toprule
   \textbf{ Parámetros de entrada} & \textbf{Parámetros de salida} \\
   \midrule
    Número de nodos \textcolor{blue}{n} & Vector de nodos \textcolor{blue}{ti}\\
         & Vector de pesos \textcolor{blue}{wi}\\
    \bottomrule
    \end{tabular}

    \label{tab:my_label}
\end{table}
\begin{enumerate}
\item Evaluar los \textcolor{blue}{posibles casos} según los nodos pedidos.
\item El vector de nodos intermedios \textcolor{blue}{ti}: Polinomio de Legendre de grado $n-1$, su derivada y las raíces de esta.
\item El vector de pesos \textcolor{blue}{wi}.
\item El vector de nodos completo \textcolor{blue}{ti} y programa final.
\end{enumerate}
\end{frame}

%------------------------------------------------
\subsection{Posibles casos según los nodos pedidos}
\begin{frame}
\frametitle{Posibles casos según los nodos pedidos}
\begin{block}{$n<2$}
No es posible calcular  la cuadratura por:
\begin{itemize}
    \item $n=1$:
    \begin{itemize}
        \item No hay suficientes nodos para incluir los extremos de la cuadratura $−1$ y $1$.
        \item Con un único nodo no captaría ninguna curvatura, luego no hay forma de aproximar con precisión.
    \end{itemize}
    \item $n<1$: 
    \begin{itemize}
        \item No tiene sentido calcular una cuadratura sin nodos, o con nodos negativos.
    \end{itemize}
\end{itemize}
Se mostrará el mensaje \textit{"Se necesitan al menos 2 nodos para la cuadratura"}.
\end{block}

\end{frame}

\begin{frame}
\frametitle{Posibles casos según los nodos pedidos}

\begin{block}{$n=2$}
El vector de nodos $ti=[-1\quad 1]$, y solo hay que calcular el vector de pesos $wi=[w_1\quad w_n]=\left[\tfrac{2}{n(n-1)}\quad \tfrac{2}{n(n-1)}\right]$.
\end{block}

\begin{block}{$n>2$} 
El vector de nodos $ti=[-1\quad t_i \quad 1]$, donde $t_i$, $i=2, 3,...,n-1$, son las raíces del polinomio $p'_{n-1}(t)$, siendo $p_{n-1}(t)$ el polinomio de Legendre de grado $n-1$.

El vector de pesos 

$wi=[w_1 \quad w_i \quad w_n]= \left[\tfrac{2}{n(n-1)} \quad \frac{2}{n(n-1)(p_{n-1}(t_i))^2} \quad \tfrac{2}{n(n-1)}\right]$
.
\end{block}
\end{frame}

%------------------------------------------------
\subsection{El vector de nodos intermedios $ti$}
%------------------------------------------------
\begin{frame}
\frametitle{El vector de nodos intermedios $ti$}

\textbf{Polinomio de Legendre de orden $n-1$}
\begin{itemize}
    \item Código auxiliar $LegendreT.m$, que devuelve los coeficientes truncados.
    \item Lo guardamos en el vector $cl$.
    \begin{lstlisting} $cl=LegendreT(n-1)$
    \end{lstlisting}
    
\end{itemize}

\vspace{1em}

\textbf{Derivada del polinomio de Legendre de orden $n-1$.}
\\ Aplicamos la regla de derivación de polinomios:
\[
\frac{d}{dx}(a_k x^k)=k a_k x^{k-1}
\]
Los coeficientes de la derivada los guardaremos en el vector \textit{ci}.
La derivada del polinomio de grado $n-1$ tiene grado $n-2$, eliminamos el último término correspondiente al grado 0, cuya derivada es 0.  \begin{lstlisting}
ci=((n-1):-1:0).*cl;
ci=ci(:,(1:n-1));
\end{lstlisting}

\end{frame}


%------------------------------------------------
\subsection{El vector de pesos $wi$}
%------------------------------------------------
\begin{frame}
\frametitle{El vector de pesos $wi$}
$wn=w_1=w_n$
calculamos los pesos de los extremos $w_1$ y $w_n$, que asignamos a la variable \textit{wn}, y definimos el vector, por ahora vacío, \textit{wi}.

Luego, calculamos mediante un bucle \textit{for} los pesos intermedios $w_i$, que se pueden expresar como
\end{frame}
%------------------------------------------------
\section{Gauss-Lobatto para 8 y 9 nodos}
%------------------------------------------------

\begin{frame}
\frametitle{Gauss-Lobatto para 8 y 9 nodos}
Para justificar los resultados obtenidos por el programa \texttt{GaussLobatto} nos basaremos en un par de propiedades de los pesos y los nodos que demostraremos a continuación:
\begin{itemize}
    \item Simetría de nodos respecto al 0
    \item La suma de todos los pesos es igual a 2 y son simétricos respecto a su máximo
\end{itemize}
\end{frame}

%------------------------------------------------
\subsection{Simetría de nodos y pesos}
%------------------------------------------------
\begin{frame}
\frametitle{Paridad e imparidad de polinomios de Legendre}
Queremos probar que el polinomio de Legendre $l_i$ es función par si $i=2k$ e impar si $i=2k+1$, $k\in\mathbb{N}\cup\{0\}$ por el método de inducción. Podemos ver que para los casos $i=0, 1, 2, 3$ se cumple:
\[l_0=1\quad;\quad l_1=x\quad;\quad l_2=x^2-\frac{1}{3}\quad;\quad l_3=x^3-\frac{3}{5}x \]
\begin{itemize}



\end{frame}

%------------------------------------------------

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{Verbatim}
\begin{example}[Theorem Slide Code]
\begin{verbatim}
\begin{frame}
\frametitle{Theorem}
\begin{theorem}[Mass--energy equivalence]
$E = mc^2$
\end{theorem}
\end{frame}\end{verbatim}
\end{example}
\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Figure}
Uncomment the code on this slide to include your own image from the same directory as the template .TeX file.
%\begin{figure}
%\includegraphics[width=0.8\linewidth]{test}
%\end{figure}
\end{frame}
%------------------------------------------------
\section{Integracion mediante Gauss-Lobatto}
%------------------------------------------------

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{Gauss-Lobatto con extremos -1 y 1}
\begin{example}[Gauss-Lobatto con extremos -1 y 1]
\begin{verbatim}
function I = integraGaussLobatto(f,n)
%I = integraGaussLobatto(f,n)
[ti,wi]=GaussLobatto(n);
fi=[];
for i=1:n
    fi=[fi f(ti(i))];
end
s=fi.*wi;
I=sum(s);
end\end{verbatim}
\end{example}
\end{frame}

%------------------------------------------------

%------------------------------------------------

%\subsection{Subsection Example} % A subsection can be created just before a set of slides with a common theme to further break down your presentation into chunks

\begin{frame}
\frametitle{Gauss-Lobatto con extremos a y b}
El procedimiento es igual al apartado anterior, solo hay que realizar el \textcolor{blue}{cambio de variable}:
\[x=\frac{b-a}{2}t-\frac{b+a}{2},\quad dx=\frac{b-a}{2}dt,\]
\\~\\
por lo que podemos aproximar
\[\displaystyle I=\int_{a}^{b} \! f(x)  \,dx = \frac{b-a}{2} \sum_{i=1}^{n}w_i f \left(\frac{b-a}{2}t_i + \frac{b+a}{2} \right)\]
\end{frame}

%------------------------------------------------

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{Gauss-Lobatto con extremos a y b}
\begin{example}[Gauss-Lobatto con extremos a y b]
\begin{verbatim}
function I = integraGaussLobattoAB(a,b,f,n)
%I = integraGaussLobattoAB(f,n)
[ti,wi]=GaussLobatto(n);
ba=ones(1,n)*(b+a)/2;
ti=(ti*(b-a)/2)+ba;
fi=[];
for i=1:n
    fi=[fi f(ti(i))];
end
s=fi.*wi;
I=sum(s)*(b-a)/2;
end\end{verbatim}
\end{example}
\end{frame}

%------------------------------------------------
%------------------------------------------------

%\subsection{Subsection Example} % A subsection can be created just before a set of slides with a common theme to further break down your presentation into chunks

\begin{frame}
\frametitle{Gauss-Lobatto con extremos a y b para integrales impropias}
Consideramos una sucesión decreciente convergente a cero
y aproximar el valor de la integral como suma finita de integrales propias.
$$
\int_{a + s_n}^b f(x) \, dx + \int_{a + s_{n-1}}^{a + s_n} f(x) \, dx + \cdots + \int_{a + s_1}^{a + s_2} f(x) \, dx \stackrel{*}= \int_a^b f(x) \, dx \quad $$
$$\Rightarrow \int_{a + s_1}^b f(x) \, dx + \int_{a + s_2}^{a + s_1} f(x) \, dx + \cdots = \lim_{n \rightarrow \infty} \int_{a + s_n}^b f(x) \, dx = \int_{a + 0}^b f(x) \, dx = \int_a^b f(x) \, dx$$
\\~\\
\end{frame}

%------------------------------------------------
%------------------------------------------------

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{Citation}
An example of the \verb|\cite| command to cite within the presentation:\\~

This statement requires citation \cite{p1}.
\end{frame}

%------------------------------------------------

%% Bibliografía
\begin{frame}
\frametitle{Referencias}
\footnotesize{
  \begin{thebibliography}{99} % Beamer does not support BibTeX so references must be inserted manually as below
    \bibitem[Smith, 2012]{p1} John Smith (2012)
      \newblock Title of the publication
      \newblock \emph{Journal Name} 12(3), 45 -- 678.
  \end{thebibliography}
}
\end{frame}

%------------------------------------------------

\begin{frame}
\Huge{\centerline{Fin.}}
\end{frame}

%----------------------------------------------------------------------------------------

\end{document} 